# Fichier: config.yaml
# Version: 3.0.0 (Refs J.1, J.4, J.5, J.7, J.8, J.9)

ai_analysis:
  max_trades_in_prompt: 50
api:
  host: 127.0.0.1
  port: 5000
backtest_settings:
  commission_per_lot: 7
  simulated_spread_pips: 1.5
learning:
  enabled: false
  min_trades_for_analysis: 10
mt5_credentials:
  login: 10008432
  password: jsne80aX!
  server: Axi-US50-Demo
 # login: 1511921064 # Remplacez par vos identifiants
  #password: r9r?N89G@H # Remplacez par vos identifiants
  #server: FTMO-Demo # Remplacez par votre serveur
pattern_detection:
  CHANGE_OF_CHARACTER: true
  INBALANCE: true
  LIQUIDITY_GRAB: true
  ORDER_BLOCK: true
  SMC_AMD_SESSION: true
  # (J.1) Logique d'entrée (0.0 = Proximal, 0.5 = Mean Threshold/50%, 1.0 = Distal)
  entry_logic:
    ob_entry_level: 0.5 # Défaut 0.5 (Mean Threshold)
    fvg_entry_level: 0.5 # Défaut 0.5 (50% FVG)
professional_journal:
  enabled: true
  file_path_template: Journal_Trading_{month_name}_{year}.csv
risk_management:
  atr_settings:
    BTCUSD:
      sl_multiple: 1.2
      tp_multiple: 2.5
    ETHUSD:
      sl_multiple: 1.2
      tp_multiple: 2.5
    XAUUSD:
      sl_multiple: 1.8
      tp_multiple: 3.5
    default:
      period: 14
      sl_multiple: 1.5 # Utilisé pour buffer SL structurel
      tp_multiple: 3   # Utilisé si tp_strategy = ATR_MULTIPLE
  breakeven:
    enabled: true
    breakeven_trigger_rr: 1.0 # (J.7) Déclenche BE à 1R (si > 0)
    breakeven_plus_atr_multiple: 0.2 # (J.7) SL déplacé à Entrée + 0.2*ATR
    trigger_pips: 100 # (Fallback si breakeven_trigger_rr = 0)
    pips_plus: 10     # (Fallback si breakeven_plus_atr_multiple = 0)
  daily_loss_limit_percent: 2
  max_total_risk_percent: 5.0 # (J.4) Risque max cumulé (toutes positions)
  partial_tp:
    be_pips_plus_after_tp1: 5
    enabled: true
    levels:
    - percentage: 50
      rr: 1
    - percentage: 30 # Pourcentage *additionnel* (total 80%)
      rr: 2
    move_sl_to_be_after_tp1: true
  risk_per_trade: 0.01 # 1% par trade
  sl_buffer_atr_multiple: 1.0 # (J.5) Buffer SL = 1.0 * ATR(14)
  sl_buffer_pips: 0 # (Fallback si sl_buffer_atr_multiple = 0)
  sl_strategy: SMC_STRUCTURE # Définit le SL sous/au-dessus de la zone FVG/OB
  tp_strategy: SMC_LIQUIDITY_TARGET # Utilise la cible de liquidité du pattern_detector
  trailing_stop_atr:
    activation_multiple: 2
    enabled: true
    trailing_multiple: 1.8
sound_alerts:
  enabled: true
  sound_file: ./alert.wav
trading_settings:
  crypto_symbols:
  - BTCUSD
  - ETHUSD
  live_trading_enabled: True
  magic_number: 13579
  symbols:
  - XAUUSD
  - XAGUSD
  - EURUSD
  - GBPUSD
  - NZDUSD
  - AUDUSD
  - USDCAD
  #- USOIL # Symbole invalide chez FTMO Demo
  - BTCUSD
  - ETHUSD
  timeframe: M15
  trading_sessions: # UTC times
  - 1-00:00-23:59 # Lundi
  - 2-00:00-23:59 # Mardi
  - 3-00:00-23:59 # Mercredi
  - 4-00:00-23:59 # Jeudi
  - 5-00:00-21:00 # Vendredi (clôture MT5)
  idempotency_lock_seconds: 900 # (J.9) Verrouillage 15 min
  pending_order_expiry_candles: 5 # (R7) Annuler ordre limite si non déclenché après 5 bougies M15

# (R4) Section pour surcharger les paramètres MT5 incorrects
symbol_overrides:
  ETHUSD:
    contract_size: 100 # FTMO Demo utilise 100, MT5 API dit 10
  BTCUSD:
    contract_size: 1   # FTMO Demo utilise 1, MT5 API dit 1
  XAUUSD:
    contract_size: 100
  XAGUSD:
    contract_size: 5000

trend_filter:
  ema_period: 200
  enabled: true
  higher_timeframe: H4
  allow_reversals: true # (J.8) Autoriser CHOCH/Liquidity Grab contre tendance HTF